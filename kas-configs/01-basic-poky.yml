# KAS Configuration 1: Basic Poky Setup
# Minimal configuration with core Poky layers for baseline testing

header:
  version: 14

distro: poky
machine: qemux86-64

repos:
  poky:
    url: https://git.yoctoproject.org/poky
    refspec: scarthgap
    layers:
      meta:
      meta-poky:
      meta-yocto-bsp:

local_conf_header:
  base: |
    # Basic configuration for accuracy testing
    PACKAGE_CLASSES = "package_rpm"

    # Enable systemd for testing systemd-related dependencies
    DISTRO_FEATURES:append = " systemd"
    DISTRO_FEATURES_BACKFILL_CONSIDERED = "sysvinit"
    VIRTUAL-RUNTIME_init_manager = "systemd"
    VIRTUAL-RUNTIME_initscripts = ""

    # Common features for testing
    DISTRO_FEATURES:append = " pam ipv6 usrmerge"

    # Reduce build time for testing
    BB_NUMBER_THREADS = "4"
    PARALLEL_MAKE = "-j 4"

    # Enable build history for comparison
    INHERIT += "buildhistory"
    BUILDHISTORY_COMMIT = "1"

bblayers_conf_header:
  meta: |
    # Basic Poky layers only
    BBPATH = "${TOPDIR}"
    BBFILES ?= ""
